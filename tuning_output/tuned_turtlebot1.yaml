# tuned_turtlebot1.yaml
# è‡ªåŠ¨ç”Ÿæˆçš„ä¼˜åŒ–é…ç½®
# ç”Ÿæˆæ—¶é—´: 2025-12-31 16:27:39
# åŸºäº: D:\AllControlBase\controller_ros\config\platforms\turtlebot1.yaml
#
# æœ¬é…ç½®ç”±è¯Šæ–­è°ƒä¼˜å·¥å…·è‡ªåŠ¨ç”Ÿæˆ
# è¯·åœ¨éƒ¨ç½²å‰ä»”ç»†æ£€æŸ¥å„é¡¹å‚æ•°
#
# =============================================================================
# ä¼˜åŒ–æ‘˜è¦
# =============================================================================
# æ ·æœ¬æ•°: 500
# å¹³å°: differential
# æ§åˆ¶é¢‘ç‡: 20Hz
# MPC æˆåŠŸç‡: 89.0%
# MPC å¹³å‡æ±‚è§£æ—¶é—´: 12.76ms
# æ¨ªå‘è¯¯å·®(avg): 5.02cm
# çºµå‘è¯¯å·®(avg): 10.49cm
# æ­£å¸¸çŠ¶æ€å æ¯”: 98.2%
# å¤‡ç”¨æ§åˆ¶å™¨æ¿€æ´»ç‡: 0.0%
#
# åº”ç”¨çš„ä¼˜åŒ– (1é¡¹):
#   ğŸ”´ watchdog.traj_grace_ms: 600 â†’ 900
#
# è·³è¿‡çš„å»ºè®® (6é¡¹):
#   - watchdog.imu_timeout_ms: ç½®ä¿¡åº¦(0.50)ä½äºé˜ˆå€¼(0.6)
#   - transform.fallback_duration_limit_ms: ä¸¥é‡ç¨‹åº¦(info)ä¸åœ¨è¿‡æ»¤åˆ—è¡¨ä¸­
#   - transform.source_frame: å‚æ•°ç±»å‹(diagnostic)ä¸å…è®¸è‡ªåŠ¨è°ƒä¼˜
#   - transform.error_analysis: å‚æ•°ç±»å‹(diagnostic)ä¸å…è®¸è‡ªåŠ¨è°ƒä¼˜
#   - safety.emergency_decel: å‚æ•°ç±»å‹(safety)ä¸å…è®¸è‡ªåŠ¨è°ƒä¼˜
#   ... è¿˜æœ‰ 1 é¡¹
#

# =============================================================================
# ç³»ç»Ÿé…ç½®
# =============================================================================
system:
  platform: differential
  ctrl_freq: 20

# =============================================================================
# è¿åŠ¨çº¦æŸ - TurtleBot1 å®‰å…¨é™åˆ¶
# =============================================================================
constraints:
  v_max: 0.5
  v_min: -0.2
  omega_max: 1.0
  omega_max_low: 0.5
  v_low_thresh: 0.1
  a_max: 0.5
  alpha_max: 1.5

# =============================================================================
# è¶…æ—¶é…ç½® (Watchdog) - é€‚åº” TurtleBot1 è¾ƒä½ä¼ æ„Ÿå™¨é¢‘ç‡
# =============================================================================
watchdog:
  odom_timeout_ms: 500
  traj_timeout_ms: 1000
  traj_grace_ms: 900
  imu_timeout_ms: -1
  startup_grace_ms: 5000
  absolute_startup_timeout_ms: -1

# =============================================================================
# è¯Šæ–­é…ç½®
# =============================================================================
diagnostics:
  publish_rate: 5

# =============================================================================
# MPC é…ç½® - é’ˆå¯¹ TurtleBot1 ä¼˜åŒ–
# =============================================================================
mpc:
  horizon: 7
  horizon_degraded: 4
  dt: 0.1
  weights:
    position: 15.0
    velocity: 6.0
    heading: 8.0
    control_accel: 0.1
    control_alpha: 0.1
  health_monitor:
    time_warning_thresh_ms: 20
    time_critical_thresh_ms: 40
    time_recovery_thresh_ms: 15
    consecutive_warning_limit: 10
    consecutive_recovery_limit: 5
  fallback:
    lookahead_steps: 3

# =============================================================================
# è½¨è¿¹é…ç½®
# =============================================================================
trajectory:
  low_speed_thresh: 0.05
  min_points: 2
  max_points: 100
  max_point_distance: 10.0
  default_dt_sec: 0.1

# =============================================================================
# ä¸€è‡´æ€§æ£€æŸ¥é…ç½® - TurtleBot1 ä¼˜åŒ–
# =============================================================================
consistency:
  alpha_min: 0.1
  kappa_thresh: 0.5
  v_dir_thresh: 0.8
  temporal_smooth_thresh: 0.5
  max_curvature: 10.0
  temporal_window_size: 10
  weights:
    kappa: 0.3
    velocity: 0.3
    temporal: 0.4

# =============================================================================
# è·Ÿè¸ªè´¨é‡è¯„ä¼°é…ç½® - TurtleBot1 å·®é€Ÿè½¦ç‰¹æ€§
# =============================================================================
tracking:
  lateral_thresh: 0.25
  longitudinal_thresh: 0.6
  heading_thresh: 0.5

# =============================================================================
# å®‰å…¨é…ç½®
# =============================================================================
safety:
  emergency_decel: 1.0
  v_stop_thresh: 0.05
  stopping_timeout: 5.0
  state_machine:
    alpha_disable_thresh: 0.0
    mpc_recovery_thresh: 5
    mpc_recovery_tolerance: 1
    mpc_fail_window_size: 10
    mpc_fail_thresh: 3

# =============================================================================
# å¤‡ä»½æ§åˆ¶å™¨é…ç½® (Pure Pursuit) - TurtleBot1 ä¼˜åŒ–
# =============================================================================
backup:
  lookahead_dist: 0.5
  min_lookahead: 0.3
  max_lookahead: 1.5
  lookahead_ratio: 0.5
  kp_heading: 2.0
  heading_error_thresh: 1.047
  max_curvature: 5.0
  default_speed_ratio: 0.5
  min_distance_thresh: 0.1

# =============================================================================
# åæ ‡å˜æ¢é…ç½®
# =============================================================================
transform:
  source_frame: base_footprint
  target_frame: odom
  timeout_ms: 50

# =============================================================================
# cmd_vel é€‚é…å™¨é…ç½®
# =============================================================================
cmd_vel_adapter:
  publish_rate: 20.0
  cmd_timeout: 0.5
  enable_rate_limit: true
  joy_topic: /joy_cmd_vel
  mode_topic: /visualizer/control_mode
  output_topic: /mobile_base/commands/velocity

# =============================================================================
# è¯é¢˜é…ç½® - TurtleBot1 ç‰¹æœ‰
# =============================================================================
topics:
  odom: /odom
  imu: ''
  trajectory: /nn/local_trajectory
  cmd_unified: /cmd_unified