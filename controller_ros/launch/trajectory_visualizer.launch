<?xml version="1.0"?>
<!--
  轨迹可视化 Launch 文件
  
  功能: 在相机图像上实时显示网络输出的轨迹点 (使用单应性变换)
  
  使用方法:
    # 正常运行 (需要先标定)
    roslaunch controller_ros trajectory_visualizer.launch
    
    # 标定模式
    roslaunch controller_ros trajectory_visualizer.launch calibration_mode:=true
    
    # 不显示窗口
    roslaunch controller_ros trajectory_visualizer.launch show_window:=false
-->
<launch>
  <!-- ========== 参数 ========== -->
  <arg name="image_topic" default="/usb_cam/image_raw" doc="相机图像话题"/>
  <arg name="trajectory_topic" default="/nn/local_trajectory" doc="轨迹话题"/>
  <arg name="output_topic" default="/trajectory_overlay/image" doc="输出图像话题"/>
  <arg name="show_window" default="true" doc="是否显示 OpenCV 窗口"/>
  <arg name="calibration_mode" default="false" doc="是否进入标定模式"/>
  <arg name="calibration_file" default="$(find controller_ros)/config/homography_calib.yaml" doc="标定文件路径"/>
  
  <!-- ========== 轨迹可视化节点 ========== -->
  <node pkg="controller_ros" type="trajectory_visualizer.py" name="trajectory_visualizer" 
        output="screen">
    <param name="image_topic" value="$(arg image_topic)"/>
    <param name="trajectory_topic" value="$(arg trajectory_topic)"/>
    <param name="output_topic" value="$(arg output_topic)"/>
    <param name="show_window" value="$(arg show_window)"/>
    <param name="calibration_mode" value="$(arg calibration_mode)"/>
    <param name="calibration_file" value="$(arg calibration_file)"/>
  </node>
</launch>
